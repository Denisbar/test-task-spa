{
    "sourceFile": "src/app/views/app/app.view.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1769949424011,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1769949424011,
            "name": "Commit-0",
            "content": "import Backbone from \"backbone\";\nimport MenuView from \"../menu/menu.view.js\";\nimport TabView from \"../tabs/tab.view.js\";\nimport ContentView from \"../content/content.view.js\";\nimport stateModel from \"../../models/state.model.js\";\n\nimport BlocksCollection from \"../../collections/blocks.collection.js\";\nimport MenusCollection from \"../../collections/menus.collection.js\";\nimport TabsCollection from \"../../collections/tabs.collection.js\";\nimport ErrorView from \"../errors/error.view.js\";\n\nconst AppView = Backbone.View.extend({\n    el: \"#app\",\n\n    async initialize() {\n        this.blocks = new BlocksCollection();\n        this.menus = new MenusCollection();\n        this.tabsCollection = new TabsCollection();\n        console.log('herer');\n        \n        console.log('change in master');\n        console.log('change in master');\n        console.log('change in master');\n        console.log('change in master');\n        console.log('change in master');\n         // some change 1\n\n        // some change\n\n        console.log('change in master');\n        console.log('change in master');\n        console.log('change in master');\n\n        // foos\n        this.contentView = new ContentView({\n            model: stateModel,\n            collection: this.blocks\n        });\n\n        this.contentView = new ContentView({\n            model: stateModel,\n            collection: this.blocks\n        });\n\n        this.contentView = new ContentView({\n            model: stateModel,\n            collection: this.blocks\n        });\n        this.menuView = new MenuView({\n            model: stateModel,\n            collection: this.menus,\n            contentView: this.contentView\n        });\n        this.tabView = new TabView({\n            model: stateModel,\n        });\n\n        try {\n            // Wait for menus to load\n            const defaultMenu = stateModel.get(\"menu\") || \"products\";\n            await this.menus.fetchMenus();\n\n            // Set initial tabs\n            await this.tabsCollection.setMenu(defaultMenu);\n            this.onStateChange();\n        } catch (err) {\n            const errorView = new ErrorView({ \n                message: \"Error loading app. Please try again later.\",\n                details: err.message \n            });\n            this.$el.empty().append(errorView.render().el);\n        }\n\n        this.listenTo(stateModel, \"change\", this.render);\n        this.listenTo(stateModel, \"change:menu change:tab\", this.onStateChange);\n\n        this.listenTo(stateModel, \"change:menu change:tab\", this.onStateChange);\n    },\n\n    async onStateChange() {\n        try {\n            const menu = stateModel.get(\"menu\");\n            let tab = stateModel.get(\"tab\");\n\n            const currentTabsMenu = this.tabsCollection.at(0)?.get(\"menuKey\");\n            if (currentTabsMenu !== menu) {\n                await this.tabsCollection.setMenu(menu);\n            }\n            // If tab not selected then take first from coll\n            if (menu && !tab) {\n                const tabs = await this.tabsCollection.setMenu(menu);\n                tab = this.tabsCollection.at(0)?.get(\"key\") || \"\";\n                stateModel.set({ tab });\n            }\n\n            if (menu && tab) {\n                await this.blocks.setTab(menu, tab);\n                this.contentView.renderBlocks();\n            }\n\n            this.render();\n        } catch (err) {\n            console.error(\"Error in onStateChange:\", err);\n            const errorView = new ErrorView({ \n                message: \"Error loading content. Please try again later.\",\n                details: err.message \n            });\n            this.$el.empty().append(errorView.render().el);\n        }\n    },\n\n    render() {\n        const menu = stateModel.get(\"menu\");\n        const tab = stateModel.get(\"tab\");\n        const collapsed = stateModel.get(\"collapsed\");\n\n        this.contentView.render(menu, tab, collapsed);\n        this.menuView.render(menu);\n        this.tabView.render(menu, tab);\n    }\n});\n\nexport default AppView;\n"
        }
    ]
}